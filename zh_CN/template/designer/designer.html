
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="MetatoCome, Workflow, Hyper Automation">
      
      
        <meta name="author" content="Lucas Kehong Liu">
      
      
        <link rel="canonical" href="https://cnshsliu.github.io/mtcdocs/zh_CN/template/designer/designer.html">
      
      <link rel="icon" href="../../../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>流程设计 - MetatoCome文档</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../index.html" title="MetatoCome文档" class="md-header__button md-logo" aria-label="MetatoCome文档" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            MetatoCome文档
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              流程设计
            
          </span>
        </div>
      </div>
    </div>
    
    
      <div class="md-header__option">
        <div class="md-select">
          
          <button class="md-header__button md-icon" aria-label="Select language">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.52 17.52 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04M18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12m-2.62 7 1.62-4.33L19.12 17h-3.24Z"/></svg>
          </button>
          <div class="md-select__inner">
            <ul class="md-select__list">
              
                <li class="md-select__item">
                  <a href="../../../template/designer/designer.html" hreflang="en" class="md-select__link">
                    Default (en)
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="../../../en/template/designer/designer.html" hreflang="en" class="md-select__link">
                    English
                  </a>
                </li>
              
                <li class="md-select__item">
                  <a href="designer.html" hreflang="zh_CN" class="md-select__link">
                    中文
                  </a>
                </li>
              
            </ul>
          </div>
        </div>
      </div>
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../../index.html" class="md-tabs__link">
      首页
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../concept.html" class="md-tabs__link md-tabs__link--active">
        流程规划
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../process/start.html" class="md-tabs__link">
        进程管理
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../work/worklist.html" class="md-tabs__link">
        任务管理
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../account/adminreg.html" class="md-tabs__link">
        设置
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../api.html" class="md-tabs__link">
        开发者
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../qa.html" class="md-tabs__link">
      Q&A
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../about.html" class="md-tabs__link">
      关于我们
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../index.html" title="MetatoCome文档" class="md-nav__button md-logo" aria-label="MetatoCome文档" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    MetatoCome文档
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../index.html" class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          流程规划
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="流程规划" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          流程规划
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../concept.html" class="md-nav__link">
        基本概念
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../explorer.html" class="md-nav__link">
        流程浏览
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          流程设计
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="designer.html" class="md-nav__link md-nav__link--active">
        流程设计
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    建议编辑步骤
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    流程设计器
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    指针 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    节点类型
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    节点属性
  </a>
  
    <nav class="md-nav" aria-label="节点属性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#id" class="md-nav__link">
    节点 ID
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    活动节点 
  </a>
  
    <nav class="md-nav" aria-label="活动节点 ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    标题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    参与
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    投票
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    任务要求说明
  </a>
  
    <nav class="md-nav" aria-label="任务要求说明">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#html" class="md-nav__link">
    HTML 标签
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#handlebars" class="md-nav__link">
    Handlebars
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    方括号中的参数名
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crontab" class="md-nav__link">
    Crontab 定时重复
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    参数定义
  </a>
  
    <nav class="md-nav" aria-label="参数定义">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    参数名称:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    参数类型:
  </a>
  
    <nav class="md-nav" aria-label="参数类型:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    组织结构选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    用户选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    文件上传
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    内部变量
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    下拉选择的可选项
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    表格
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    参数值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    公式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_24" class="md-nav__link">
    标题
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_25" class="md-nav__link">
    占位字符
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_26" class="md-nav__link">
    新启一行
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#id_1" class="md-nav__link">
    ID
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_27" class="md-nav__link">
    必须输入
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_28" class="md-nav__link">
    可见性
  </a>
  
    <nav class="md-nav" aria-label="可见性">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_29" class="md-nav__link">
    何时显示
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_30" class="md-nav__link">
    活动节点脚本
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_31" class="md-nav__link">
    通知节点 
  </a>
  
    <nav class="md-nav" aria-label="通知节点 ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_32" class="md-nav__link">
    操作
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_33" class="md-nav__link">
    邮件人:
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_34" class="md-nav__link">
    标题及内容
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_35" class="md-nav__link">
    脚本节点 
  </a>
  
    <nav class="md-nav" aria-label="脚本节点 ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_36" class="md-nav__link">
    同步模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_37" class="md-nav__link">
    异部模式
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_38" class="md-nav__link">
    脚本代码
  </a>
  
    <nav class="md-nav" aria-label="脚本代码">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_39" class="md-nav__link">
    脚本返回值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_40" class="md-nav__link">
    向流程注入参数值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_41" class="md-nav__link">
    取得流程参数值
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_42" class="md-nav__link">
    设置内部团队
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_43" class="md-nav__link">
    其它可以在脚本中使用的函数
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    同步方式，调用一个远程服务 API
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api_1" class="md-nav__link">
    异步方式，调用一个远程服务 API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_44" class="md-nav__link">
    延时节点 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_45" class="md-nav__link">
    子流程节点 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#and" class="md-nav__link">
    AND 节点 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#or" class="md-nav__link">
    OR 节点 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_46" class="md-nav__link">
    接地节点 
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_47" class="md-nav__link">
    连接线 
  </a>
  
    <nav class="md-nav" aria-label="连接线 ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_48" class="md-nav__link">
    改变连接的起止节点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_49" class="md-nav__link">
    取消连接选择
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_50" class="md-nav__link">
    删除一个连接
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_51" class="md-nav__link">
    给连接一个路径值
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_52" class="md-nav__link">
    编辑操作
  </a>
  
    <nav class="md-nav" aria-label="编辑操作">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_53" class="md-nav__link">
    拷贝、粘贴节点
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_54" class="md-nav__link">
    连接线文本
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_55" class="md-nav__link">
    键盘快捷键
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#-" class="md-nav__link">
    单选-多选
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_56" class="md-nav__link">
    移动节点
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="pds.html" class="md-nav__link">
        角色定义
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          进程管理
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="进程管理" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          进程管理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/start.html" class="md-nav__link">
        启动一个进程
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/explorer.html" class="md-nav__link">
        进程浏览器
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/overview.html" class="md-nav__link">
        进程总览
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/worklog.html" class="md-nav__link">
        工作记录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../process/monitor.html" class="md-nav__link">
        进程监控器
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          任务管理
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="任务管理" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          任务管理
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../work/worklist.html" class="md-nav__link">
        工作列表
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../work/workpage.html" class="md-nav__link">
        工作项操作
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          设置
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="设置" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          设置
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../account/adminreg.html" class="md-nav__link">
        组织账号
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/tenant.html" class="md-nav__link">
        企业账户管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/orgchart.html" class="md-nav__link">
        组织结构
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/members.html" class="md-nav__link">
        成员管理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/resign.html" class="md-nav__link">
        用户替换及离职处理
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/delegation.html" class="md-nav__link">
        Delegation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/myfiles.html" class="md-nav__link">
        MyFiles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../admin/smtp.html" class="md-nav__link">
        SMTP
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          开发者
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="开发者" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          开发者
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../api.html" class="md-nav__link">
        API
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../sdk.html" class="md-nav__link">
        SDK
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integration.html" class="md-nav__link">
        Integration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../qa.html" class="md-nav__link">
        Q&A
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../about.html" class="md-nav__link">
        关于我们
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="_1">流程规划</h1>
<h2 id="_2">建议编辑步骤</h2>
<p>流程设计的建议步骤如下：</p>
<ol>
<li>使用设计器设计出流程的拓扑结构，不用配置任何变量、负责人等额外信息，专注在流程的拓扑和逻辑上；</li>
</ol>
<ul>
<li>在流程流向上添加选项文本，这些选项在流程运行过程中，将作为可选项提供给用户，MTC 将根据用户的不同决策来决定流程的不同流向；</li>
<li>预演，此时所有工作都将下发给设计者本人，此时可检查流程的流向是否合理</li>
<li>留意流程的逻辑流向，是否符合设计目标。 如否，先修改再进行下一步</li>
</ul>
<ol>
<li>定义流程参数
   流程参数将提供给用户填写，也有特殊目的参数，后续将逐步说明；</li>
<li>定义控制逻辑
   使用 Javascript 脚本来对流程进行高级控制</li>
<li>添加参与人
   指定不同任务的承担人</li>
<li>预演
   多轮预演，保证流程的运行符合预期</li>
</ol>
<h2 id="_3">流程设计器</h2>
<p>工作流设计器提供图形方式用户界面，用于设计一个流程</p>
<p><img alt="desginer" src="../../img/workflow_designer.png" /></p>
<p>左侧的工具箱里的工具，用于切换当前工具，每种工具对应一种节点类型</p>
<h2 id="_4">指针 <img src="../../img/svg/POINTER.svg" width="24px" height="24px"/></h2>
<p><em>在编辑状态下任意时间按下 ESC 键即可回到指针.</em>
在指针模式下，你可以：</p>
<ol>
<li>通过点击一个节点或连接，以选中它</li>
<li>按住 SHIFT 的同时点击一个节点或连接，以打开它的属性窗口</li>
<li>按住鼠标拖动一个节点</li>
<li>在空白区域按下并拖动鼠标，以拖动画板</li>
</ol>
<p>除指针以外的其它工具对应一个流程节点类型</p>
<h2 id="_5">节点类型</h2>
<p>设计器支持多种节点类型，包括活动、通知、脚本、定时器、子流程、与、或、接地及连接</p>
<ul>
<li>活动：指一个需要人来完成的动作</li>
<li>通知：指发送邮件给特定人</li>
<li>脚本：用于在流程中嵌入 Javascript 脚本，用于控制流程的运行逻辑，通过 WebAPI 调用运行在其它系统上的服务</li>
<li>定时器：用于暂停流程一段时间，当需要在一个节点完成以后，暂停一段时间再继续下一个节点时，在两个节点之间插入一个定时器即可。定时器在间隔时间后循环运行一段流程时也非常有用。</li>
<li>子流程：用于在一个流程中嵌入另一个流程；或者触发另一个流程的独立运行。</li>
<li>与： 是一个用于判断前序节点是否已经全部完成的逻辑控制</li>
<li>或： 是一个用于判断前序节点中任意一个已经完成的逻辑控制</li>
<li>接地： 用于标识当前路径的结束，无须运行到 END 节点</li>
<li>连接： 前后两个节点之间的连线。</li>
</ul>
<h2 id="_6">节点属性</h2>
<p>大部分节点类型都有属性，Shift-点击一个节点即可打开它的属性窗口，在没有 Shift 键的移动设备上，可以通过点击选中节点右上侧的小箭头图示来打开它的属性窗口。</p>
<p>连接也有属性，通过 Shift-点击来打开</p>
<h3 id="id">节点 ID</h3>
<p>每个节点都有一个自动生成的唯一 ID。
当我们在脚本中需要参考一个节点时，可能发现自动生成的 ID 不能表达意图，此时，最好的方法是把自动生成的 ID 修改为一个有业务意义的名字。</p>
<p>在节点的属性窗口中，输入自定义 ID，然后其右侧的“设置”按钮。这个按钮必须刻意点，否则，即便你点了属性窗口的确定按钮，ID 也不会被改变。</p>
<p>在设计器顶部菜单的最右侧，你可以通过切换 checkbox 来在设计器画布上显示和隐藏每个节点的 ID 信息</p>
<h2 id="_7">活动节点 <img src="../../img/svg/ACTION.svg" width="24px" height="24px"/></h2>
<p><em>任意时间按下 1 即可选中活动</em></p>
<p>活动是指一个需要由人来完成的动作</p>
<ul>
<li>点击画布上任意位置即可放置一个活动</li>
<li>按下鼠标可拖动节点到其它位置</li>
<li>Shift-点击一个节点打开它的属性</li>
</ul>
<h3 id="_8">标题</h3>
<p>活动的名称中可嵌入流程参数值，用方括号括起来的变量名，连同方括号一起，将被替换为变量的值，如果变量不存在，替换后方括号也会被去除。</p>
<p>例如，如果流程中有一个变量名为"Interviewee_name", 它的值是"张三", 活动名称“请审批[Interviewee_name]的录用通知书”将被替换为“请审批张三的录用通知书”</p>
<h3 id="_9">参与</h3>
<p>可视使用“参与人定义字符串”（PDS）来定义活动有哪些人参与执行</p>
<p>详细信息请参考 <a href="pds.html">PDS page</a></p>
<h3 id="_10">投票</h3>
<p>如果一个活动有多个参与人，此时每个参与人的决策可能不同，而这个节点的最终决策值可以使用投票模型来计算所得</p>
<p><img src="https://cdn.jsdelivr.net/gh/cnshsliu/static.xhw.mtc/img/doc/vote_en.png" width="100px"/>
<img src="https://cdn.jsdelivr.net/gh/cnshsliu/static.xhw.mtc/img/doc/vote_zh-CN.png" width="100px"/></p>
<p>投票模型包括：</p>
<ul>
<li>
<p>依最后一人的选择:</p>
<blockquote>
<p>总是使用最后一个人的选择为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>依最多人的选择</p>
<blockquote>
<p>用最多人的选择作为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>依最少人的选择</p>
<blockquote>
<p>用最少人的选择作为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>选择全部一样，否则</p>
<blockquote>
<p>如果所有人选择都一样，则这个唯一选择作为投票结果
否则，使用“否则”设置为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>某一选择超过比例，否则</p>
<blockquote>
<p>使用比例超过所设置数值的选项为投票结果
否则，使用“否则”设置为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>只要有选，否则依最后</p>
<blockquote>
<p>只要有人选择某个选项，则投票结束，投票结果为这个值
否则，依最后一个人的选择为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>只要有选，否则依最多</p>
<blockquote>
<p>只要有人选择某个选项，则投票结束，投票结果为这个值
否则，依最多人的选择为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>只要有选，否则依最少</p>
<blockquote>
<p>只要有人选择某个选项，则投票结束，投票结果为这个值
否则，依最少人的选择为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>只要有选，否则依统一选择 或最多</p>
<blockquote>
<p>只要有人选择某个选项，则投票结束，投票结果为这个值
否则，依全体人的选择为投票结果
如果，全体人员选择不统一， 则使用最多人的选择为投票结果</p>
</blockquote>
</li>
</ul>
<ul>
<li>
<p>只要有选，否则</p>
<blockquote>
<p>只要有人选择某个选项，则投票结束，投票结果为这个值
否则，使用“否则”设置为投票结果</p>
</blockquote>
</li>
</ul>
<h3 id="_11">任务要求说明</h3>
<p>参与人接收到任务后，需要一些指引来对当前工作要求作出说明</p>
<p>说明中可以使用部分 HTML 标签，也可以使用 <a href="#handlebars">Handlebars</a> 模版方式或者方括号中的变量名方式嵌入流程参数</p>
<h4 id="html">HTML 标签</h4>
<p>安全起见，只有部分 HTML 标签是可以使用的，包括：</p>
<blockquote>
<p>"b", "i", "em", "strong", "a", "blockquote", "li", "ol", "ul", "br", "code", "span", "sub", "sup", "table", "thead", "th", "tbody", "tr", "td", "div", "p", "h1", "h2", "h3", "h4"</p>
</blockquote>
<h4 id="handlebars">Handlebars</h4>
<p>关于 Handlebars 格式的详细说明，请自动搜索</p>
<p>Handlebars 格式中可潜入流程参数，例如，如果一个流程中有参数 "days", 那么， handlebars 中的 {{days.value}} 将被替换为 days 这个参数的值。
也可以包含{{days.title}} {{days.type}} 等，分别是 days 的标题和类型</p>
<h4 id="_12">方括号中的参数名</h4>
<p>[var_name] 将被替换为 var_name 的值</p>
<h3 id="crontab">Crontab 定时重复</h3>
<p>你可以对一个活动设置定时下发。如下图
<img alt="crontab" src="https://cdn.jsdelivr.net/gh/cnshsliu/static.xhw.mtc/img/doc/activity_crontab.zh-CN.png" />
了解 Crontab 标准，将有利于您理解定时器的设置方法。请搜索 crontab。
MTC 提供上图中的编辑器，方便你的定时器设置。</p>
<h2 id="_13">参数定义</h2>
<p>定义参数名称，参数类型等。</p>
<h3 id="_14"><strong>参数名称</strong>:</h3>
<p>参数名必须是一个合法的 Javascript 参数名称，意味着，参数名必须
以大小写字母，下划线开始，跟着一到多个字母、下划线或数字。
如果参数名称不合法，将会导致你的流程无法正常运行</p>
<h3 id="_15"><strong>参数类型</strong>:</h3>
<p>参数类型通过在参数名称中添加固定的前缀来实现，前缀定义了 MTC 将按照何种类型来处理这个参数，以及在界面上如何向用户显示这个参数的输入方式</p>
<p>参数类型包括：</p>
<ul>
<li>"email_" : 需要输入一个合法的邮箱地址</li>
<li>"password_" : 需要输入一个密码</li>
<li>"url_" : 输入一个 URL 地址</li>
<li>"range_" : 一个数值范围</li>
<li>"number_" : 一个数字，可设置最小、最大、步调的值</li>
<li>"dt_" : 一个日期+时间输入框</li>
<li>"datetime_" : 同上</li>
<li>"date_" : 一个日期输入框</li>
<li>"time_" : 时间输入框</li>
<li>"color_" : 颜色输入框</li>
<li>"search_" : 搜索输入框</li>
<li>"select_" : 下拉选择</li>
<li>"sl_" : 同上</li>
<li>"sel_" : 同上</li>
<li>"file_" : 文件选择上传</li>
<li>"radio_" : 单选</li>
<li>"textarea_" : 多行文本输入</li>
<li>"ta_" : 同上.</li>
<li>"checkbox_": 选择框</li>
<li>"cb_": 同上</li>
<li>"ou_": 选择组织结构中一个部门</li>
<li>"usr_": 用户输入（邮箱前缀）</li>
<li>"user_": 同上</li>
<li>"tbl_": 表格输入</li>
<li>其它 : 一个普通的文本输入</li>
</ul>
<h4 id="_16">组织结构选择</h4>
<p>一个以"ou_" 开头的变量，将提供给用户一个针对组织结构的部门名称选择框。
组织结构由具备组织结构管理权限的用户进行管理。</p>
<p>例如， "ou_varname".
支持选项设置，设置用';'分隔, 比如"top_ou_id;[yes|no]", ';'前面是第一个组织的编号，';'后的 yes 或者 no 用来控制，是否包含这个组织, no 表示只能选择这个组织下面的组织</p>
<h4 id="_17">用户选择</h4>
<p>"usr_" 或 "user_" 开始的变量表示需要输入一个用户， 当用户在输入的同时，MTC 会查询这个用户是否存在</p>
<h4 id="_18">文件上传</h4>
<p>以"file_" 开头的变量，提供给用户一个文件选择框，用户可以拖放文件到这个区域，或者从文件浏览器选择文件，文件上传以后，用户可以查看、删除该文件（根据权限）</p>
<h4 id="_19">内部变量</h4>
<p>下面的变量是内部变量，你可以直接使用，无须定义。</p>
<p>进程级变量：</p>
<ul>
<li><strong>starter</strong>: 进程启动者的用户 id</li>
<li><strong>starterCN</strong>: 进程启动者的用户名</li>
<li><strong>ou_SOU</strong>: 进程启动者的组织结构代码</li>
<li><strong>ou_user_XYZ</strong>: 变量 user_XYZ 的值所指向的用户所在的组织结构代码</li>
</ul>
<p>系统变量</p>
<ul>
<li><strong> $$isoWeek</strong>: 按年的星期数（第几周）</li>
<li><strong> $$isoWeeksInISOWeekYear</strong>: 本年有多少个周</li>
<li><strong> $$isoWeekYear</strong>: 当前是哪一年 (按完整周)</li>
<li><strong> $$isoWeekDesc</strong>: 周的表示, 例如 W1, W13...</li>
<li><strong> $$isoWeekDescFull</strong>: 周的完整表述, 例如 W1/52-2022</li>
</ul>
<p>内部变量在下面场景也是可用的:</p>
<ul>
<li>流程上下文变量显示；</li>
<li><a href="#handlebars">Handlebars</a>, 例如: "{{starterCN.value}}"</li>
<li>活动工作项的标题, 例如: "Activity started by [starterCN]"</li>
</ul>
<h4 id="_20"><strong>下拉选择的可选项</strong></h4>
<p>以下前缀的变量支持可选项："select_", "sel_", "sl_", or "ou_",</p>
<ul>
<li>可选项用英文';'分隔，例如"option1;option2;option3";</li>
<li>对 "ou_" 变量，第一个可选项将被作为顶层组织结构，第二个是 yes 或者 no, 表示可选项中是否包含底层组织</li>
<li>可选项也可以从预定列表中获得<ul>
<li>需要在列表定义中，定义一个列表, 一个列表定义中有多个 key，一个 key 下有多个可选值</li>
<li>"R:list_group_name", 将取出 list_group_name 的缺省可选项</li>
<li>"R:list_group_name:key" 将取出 list_group_name 中 key 值下的可选项</li>
</ul>
</li>
<li>列表项支持嵌套，你可以：<ul>
<li>使用 T:cascade_list_name, 例如，你可以设置一个下拉选择框"select_A", 其可选项定义为 "R:province_list;T:select_B", 然后，你可以定义下拉选择框"select_B" 为 "R:city_list"。 当用户从 "select_A"中选择一个省份时， "select_B"将获得 "select_A"中所选的省份值， 并将这个省份值作为 key，刷新"select_B"的可选项，也就是相应省份里面的城市。</li>
</ul>
</li>
</ul>
<p>Note: 有关 list 的定义请参考列表定义中的说明</p>
<h4 id="_21"><strong>表格</strong></h4>
<p>表格栏位支持使用表格设计器来直观地创建，详见<a href="#table-designer">表格设计器</a></p>
<p>下面的说明可帮助你理解表格设计器的背后设计
表格允许用户一行一行，一栏一栏地输入数据</p>
<p>表格栏位之间用｜分隔</p>
<ul>
<li>单个栏位可以通过前缀来指定其类型<ul>
<li>"date_" (日期输入),</li>
<li>"dt_" (日期时间输入).</li>
<li>"sel_" (下拉选择框)<ul>
<li>选择框的可选项用英文 ':'分隔, 例如(OPT1:OPT2:OPT3)</li>
</ul>
</li>
</ul>
</li>
<li>栏位的标题用[title=TITLE]定义, 缺少方括号定义时，将使用变量名去除前缀后作为栏位标题</li>
<li>栏位的缺省值通过[default=DEFAULT_VALUE]来定义,</li>
<li>如果一个栏位需要计算平均值，可使用[avg]来标注</li>
<li>如果一个栏位需要计算总值，可使用[sum]来标注</li>
<li>计算两个日期之间的天数，使用 =datediff 来定义；</li>
<li>计算两个时间之间的持续天数，使用=lastingdays 来定义；</li>
</ul>
<p>例如:</p>
<pre><code>date\_开始时间[title=开始日期]|date\_结束时间|从哪里[default=机场]|到哪里[default=公司]|sel\_出行方式(飞机:高铁:长途汽车:出租车)[default=高铁]|=datediff(date\_开始时间,date\_结束时间)+1[title=出差天数(天)][default=0][avg]|dt\_开始时点|dt\_结束时点|=lastingdays(dt\_开始时点,dt\_结束时点,0.5)[title=请假天数][default=0][sum]|number\_报销金额[sum][avg]
</code></pre>
<p>上述表格定义了以下栏位：</p>
<ul>
<li>开始时间：<ul>
<li>类型：日期</li>
<li>Title: 开始日期</li>
</ul>
</li>
<li>结束时间<ul>
<li>类型：日期</li>
<li>Title: 结束时间</li>
</ul>
</li>
<li>从哪里<ul>
<li>缺省值：机场</li>
</ul>
</li>
<li>到哪里<ul>
<li>缺省值：公司</li>
</ul>
</li>
<li>出行方式<ul>
<li>类型：选择列表</li>
<li>可选项：飞机，高铁，长途汽车，出租车</li>
<li>缺省值：高铁</li>
</ul>
</li>
<li>出差天数（天）<ul>
<li>类型：公式</li>
<li>值：开始日期，与结束日期的天数差别+1，如为同一天，则值为 1.</li>
<li>缺省值：0</li>
<li>计算平均值</li>
</ul>
</li>
<li>开始时点<ul>
<li>类型：datetime</li>
</ul>
</li>
<li>结束时点<ul>
<li>类型：datetime</li>
</ul>
</li>
<li>请假天数<ul>
<li>类型：公式</li>
<li>值：开始时点，与结束时点的差别，规整到 0.5 天</li>
<li>缺省值：0</li>
<li>计算总和</li>
</ul>
</li>
<li>报销金额<ul>
<li>类型：数字</li>
<li>求总</li>
<li>求平均</li>
</ul>
</li>
</ul>
<h3 id="_22"><strong>参数值</strong></h3>
<p>栏位的缺省值</p>
<ul>
<li>输入框类型的变量，显示输入框时，其缺省值直接显示在输入框中</li>
<li>对 select/checkbox/radio, 显示时， 缺省值直接被选中</li>
</ul>
<h3 id="_23"><strong>公式 </strong></h3>
<p>可以把栏位的值设置为一个公式</p>
<p>公式定义在栏位值中，以‘=’开头</p>
<p>公式是一个合法的 Javascript 表达式，强烈建议使用简单的表达式</p>
<p>例如:</p>
<pre><code>=first_name + &quot; &quot; + last_name
</code></pre>
<p>如果 first_name 栏位值是 "John", last_name 栏位值是 "Smith", 上述表达式的结果就是"John Smith".</p>
<pre><code>=first_name.substring(1)
</code></pre>
<p>如果 first_name 的值"John", 那么结果就是 "ohn";</p>
<h3 id="_24"><strong>标题</strong></h3>
<p>该栏位的标题</p>
<h3 id="_25"><strong>占位字符</strong></h3>
<p>栏位输入框的占位字符</p>
<h3 id="_26"><strong>新启一行</strong></h3>
<p>下一个栏位新起一行</p>
<h3 id="id_1"><strong>ID</strong></h3>
<p>可选，是否给它指定一个 ID</p>
<h3 id="_27"><strong>必须输入</strong></h3>
<p>此变量必须输入，才能继续</p>
<h3 id="_28"><strong>可见性</strong></h3>
<p>使用 PDS 指定谁能看到这个参数
详细信息请参考 <a href="pds.html">PDS page</a></p>
<p><strong>Note:</strong>
有些场景下，一些敏感数据需要对某些人保密，即便这些人参与在流程中。例如，在人事面试流程中，面试官参与到一个面试流程，但 offer 中的薪资数值可能不能让面试官看到，只能由 HR 或者管理层看到，那么，我们需要使用 PDS 指定薪资这个参数的可见行给到 HR 以及管理层即可。可见性在服务端计算，被可见性保护的数据，对不在可见性设置中的用户，根本不会从服务器端下传数据。</p>
<h4 id="_29"><strong>何时显示</strong></h4>
<p>使用"when expression"来控制一个参数何时显示出来供输入
可以使用逻辑判断来比较两个值，例如，两个参数分别是 RV 和 GV，可以定义 When Expression 其对比关系。语法为：</p>
<pre><code>RV[=|==|===|&gt;|&gt;=|&lt;|&lt;=|!=]GV
</code></pre>
<p>比如我们有：</p>
<ul>
<li>一个名为 "checkbox_req"的变量，一个名为"reason"的变量，我们希望'reason'只在 checkbox_req 被选中的时候才显示，我们可以定义 reason 的"when expression"为</li>
</ul>
<pre><code>checkbox_req=true
</code></pre>
<ul>
<li>再比如，我们有一个参数名为"number_amount", 另一个参数名为"upper_price", 我们需要 upper_price 只在 number_amount 的值大于 100 时，才会显示出来供输入，我们可以定义 upper_price 的 when expression 为：</li>
</ul>
<pre><code>number_amount&gt;100
</code></pre>
<p>GV 的类型将被自动转换为 RV 的类型，用于对比。
当前，我们仅支持字符串 string，数字 number，布尔 boolean 三个类型。
当 GV 是一个字符串时，可以忽略用'"'引起来, 除非它的值是 empty</p>
<p>例如，我们对比 kvar 的值是否等于 abcd, 我们直接使用</p>
<pre><code>kvar=abcd
</code></pre>
<p>如果要对比一个变量的值是否为空，就需要使用引号了。例如：</p>
<pre><code>kvar!=''
</code></pre>
<p><strong>Note:</strong> 在浏览器客户端中， "when expression"只有在用户离开输入框时才会被触发.</p>
<h3 id="_30">活动节点脚本</h3>
<p>除了在独立的脚本节点中嵌入 Javascript 脚本外，从 Mtc5.0 开始，我们也支持直接在活动节点上设置脚本</p>
<p>需要设置活动级脚本的场景可能包括：</p>
<ol>
<li>需要对用户的选择通过脚本进行修改时</li>
<li>需要在活动完成后，执行一定操作，但又不想单独放置一个脚本节点时</li>
</ol>
<p>活动节点的脚本代码无须返回值， 如果有返回值，这个返回值将替换用户在操作界面上所作的选择作为节点的结果</p>
<p>下面的代码在活动节点上设置了一个流程变量 week，值为 3</p>
<pre><code>MtcSet('week', 3);
</code></pre>
<p>下面的代码将当前活动的结果设为 C</p>
<pre><code>ret = &quot;C&quot;;
</code></pre>
<p><strong>请记住</strong>: 除非必要，保持活动节点的脚本为空。脚本写错会导致与预期不一致的结果</p>
<p><strong>Info</strong>: 有关脚本的更多信息请参考 <a href="#script">how to script</a></p>
<h2 id="_31">通知节点 <img src="../../img/svg/INFORM.svg" width="24px" height="24px"/></h2>
<ul>
<li>在任何时间，按下 2 即可切换到通知节点
  通知节点用于向用户发送邮件</li>
</ul>
<h3 id="_32">操作</h3>
<ul>
<li>鼠标点击画板空白处，防止一个通知节点</li>
<li>Shift-点击通知节点，打开其属性配置</li>
<li>拖动通知节点移动到另一个位置</li>
</ul>
<h3 id="_33">邮件人:</h3>
<ul>
<li>指定谁将收到邮件，使用<a href="pds.html">PDS</a>来定义</li>
</ul>
<h3 id="_34">标题及内容</h3>
<ul>
<li>可以使用方括号或 <a href="#handlebars">Handlebars</a> 格式嵌入流程数据</li>
</ul>
<h2 id="_35">脚本节点 <img src="../../img/svg/SCRIPT.svg" width="24px" height="24px"/></h2>
<ul>
<li>按下 3 切换到脚本节点</li>
</ul>
<h3 id="_36">同步模式</h3>
<p>以同步模式运行脚本</p>
<h3 id="_37">异部模式</h3>
<p>以异步模式运行脚本，外部应用通过调用 MTC 回调节点，回调成功后，流程继续往后运行。</p>
<p>当脚本中调用一个外部应用，比如触发外部事件后，外部时间可能需要长时间才能完成，就可以使用异部模式来设计</p>
<h3 id="_38">脚本代码</h3>
<p>可以嵌入 Javascript 脚本</p>
<h4 id="_39">脚本返回值</h4>
<pre><code>
ret = &quot;A&quot;;

</code></pre>
<p>Return value is used as routing option to decide where to go after this script node.
返回值将被作为脚本节点的返回值，用于控制后续流程流向哪个后续节点，比如，脚本节点指向后续两个节点，一个连接线上的路径值为 A， 另一个连接线上的路径值为 B，则上述脚本运行后，将沿着路径值为 A 的连接线，运行下一个节点。</p>
<h4 id="_40">向流程注入参数值</h4>
<pre><code>kvar(var_name, var_value, var_label)
</code></pre>
<p>或</p>
<pre><code>MtcSet(var_name, var_value, var_label)
</code></pre>
<p>在流程的后续运行中， var_name 这个变量即可使用，</p>
<p>** 如果 var_name 已经存在，那么它的值将被覆盖</p>
<h4 id="_41">取得流程参数值</h4>
<pre><code>kvalue(var_name)
</code></pre>
<p>或</p>
<pre><code>MtcGet(var_name)
</code></pre>
<h4 id="_42">设置内部团队</h4>
<p>动态设置团队成员</p>
<pre><code>
setRoles({
SGT: &quot;ab@email.com&quot;,
DIRECTOR: &quot;cd@email.com&quot;,
});

</code></pre>
<p>在后面的节点中，分配给角色“SGT”的工作，将被下发给“ab@email.com”这个用户，分配给“DIRECTOR”这个角色工作，将被下发给“cd@email.com”这个用户。</p>
<p><strong>请注意：</strong>， 灵活团队中的角色与组织结构中的角色不同。
组织结构中的角色相对固定，而灵活团队中的角色可以更加灵活地设置。</p>
<h4 id="_43">其它可以在脚本中使用的函数</h4>
<pre><code>// 设置某个节点的结果值
// 请注意，在放置一个节点时，其nodeid是自动生成的，不容易记忆，设计者可以在流程设计器中，手工修改nodeid为容易记忆的字符串，一般是英文单词组成的有业务意义、切符合javascript变量名称要求的字符串，以字母开始，后续多个连续字母和数字的组合

MtcSetDecision(nodeid, value)

//取得某个节点的结果值
//例如，某个节点的nodeid为approve，且有两个选项，&quot;通过&quot;和&quot;不通过&quot;，使用这个方法可以取得用户的选择是”通过“还是”不通过“
MtcGetDecision(nodeid)

//判断一个PDS字符串中是否有某个用户
MtcPDSHasDoer(pds, who_email)

//向外部应用，传递回调接口的ID，外部系统需要记住这个ID，并在回调时使用这个ID。 在异步方式运行脚本节点时，需要向外部系统传递这个ID，否则，外部系统不知道调用那个回调接口
//url为外部系统的访问接口地址
MtcSendCBPid(url, extraPayload)

//向外部应用传递流程的所有参数
//当前进程的所有运行信息，将传递到这个endpoint
MtcSendContext(endpoint)

//流程信息将被打包在一个JSON中传递给endpoint, 例如
{
  &quot;context&quot;:{
    &quot;wfid&quot;:&quot;...&quot;, //进程ID
    &quot;tplid&quot;:&quot;...&quot;,  //模版ID
    &quot;starter&quot;: {...}, //启动者
    &quot;data1&quot;:{...}, //流程数据
    &quot;data2&quot;: {...}
  }
}

</code></pre>
<h3 id="api">同步方式，调用一个远程服务 API</h3>
<p>SCRIPT 节点运行方式设置为 同步
使用 MtcApiAgent.post(API_endpoint, payload, Axios_options);
MtcAPIAgent 就是 axios，请参考 Axios 文档. 例如：</p>
<pre><code>  ```
  let retFromRemoteAPI  = await MtcAPIAgent.post("http://Remote_API_SERVER:8008/demo/api",
  {}, {headers:{"Authorization": TOKEN_STRING}});
  ```
</code></pre>
<p>如果需要将远程 API 返回的数据写入流程上下文，可以使用前述的 MtcSet， 如</p>
<pre><code>MtcSet(&quot;Key1&quot;, retFromRemoteAPI.keys);
</code></pre>
<p>也可以直接将数据一次性写入到 retkvars， 如:</p>
<pre><code>retkvars = retFromRemoteAPI; //retFromRemtoeAPI 需要是一个JSON

retkvars = {...retkvars, ...retFromRemtoeAPI};  //保留retkvars之前的值，将retFromRemtoeAPI的值添加到retkvars
</code></pre>
<p>retkvars 的所有 key，value 将被写入流程上下文</p>
<p>一来，可以在前端显示， 二来，在后续的节点脚本中可以通过 MtcGet 获得其最新值</p>
<p>脚本中的 ret 的值将被用于判断流程后续流向。</p>
<h3 id="api_1">异步方式，调用一个远程服务 API</h3>
<p>SCRIPT 节点运行方式设置为 同步
然后，</p>
<ol>
<li>在脚本中同样使用 MtcAPIAgent 调用远程 API。</li>
<li>向远程服务，发送回调节点代码， 远程服务需要自行保存这个节点代码</li>
</ol>
<pre><code>MtcSendCBPid(remote_service_uri, extraPayloadJSON);
//remote_service_uri 服务将能拿到一个名为 cbpid 的参数， 以及 extraPayloadJSON 的内容
</code></pre>
<ol>
<li>远程服务在完成工作后（可以持续任意时间），发起向 MTC 的回调</li>
</ol>
<pre><code>POST(&quot;https://MTC_SERVER/workflow/docallback&quot;, {cbpid, decision, kvars});
</code></pre>
<p>cbpid 为之前所获得的 cbpid, decision 将决定流程下一步的走向， kvars 中的 KV 数据将被记录进流程的上下文</p>
<h2 id="_44">延时节点 <img src="../../img/svg/TIMER.svg" width="24px" height="24px"/></h2>
<p>延时节点，用于控制进程暂停时间，有三种方式：</p>
<ul>
<li>从进程启动时开始: 从进程启动时开始延时多长时间下发后续任务</li>
<li>从现在开始: 从进程达到延时节点开始延时多长时间下发后续任务</li>
<li>固定时间: 在固定时间，延时下发后续任务</li>
</ul>
<p><strong>注意</strong>： 延时节点的时间设置的目的与活动节点中的 crontab 重复执行时间设置的目的不同，延时节点用于控制后续节点的下发延时， 活动节点的 crontab 时间设置用于控制当前活动节点的重复下发时间。 参加 <a href="#crontab">Crontab</a></p>
<h2 id="_45">子流程节点 <img src="../../img/svg/SUB.svg" width="24px" height="24px"/></h2>
<p>子流程会被调用，在子流程运行完成以后，父流程继续运行</p>
<p>子流程最后的返回值将被当作子流程节点的结果值，用于判断后续运行路径</p>
<p>子流程也可以以独立运行方式运行，子流程独立运行时，父流程不会等待其结束。</p>
<h2 id="and">AND 节点 <img src="../../img/svg/AND.svg" width="24px" height="24px"/></h2>
<p>并节点需要等待其前序节点，全部完成，才会进行后续工作。
如果流程中存在循环，AND 节点总是能做到使用最新一轮循环的结果。
例如，A 节点指向 B 和 C 节点，B 和 C 聚合到 AND， AND 后是 D， D 指向 END，D 也有一个路径指向到 A。 那么，当 BC 完成，AND 通过，D 完成后流向 A，开始新一轮。 新一轮中，B 完成，此时，即便上一轮的 C 有完成记录，AND 也不会通过，它会等待在新一轮中的 C 完成。</p>
<p><strong> 注意 </strong>
对于一些复杂的流程，AND 的运行可能与你预期不同，比如，其中一个分支中的某个节点，在特殊条件下，流向了另一个分支，这样，上一个分支就没有机会流向到 AND。流程就会停在 AND 节点上。</p>
<p><strong> 注意 </strong>
对于复杂流程，建议使用脚本节点来实现复杂并行控制。 参见脚本一节</p>
<h2 id="or">OR 节点 <img src="../../img/svg/OR.svg" width="24px" height="24px"/></h2>
<p>只有前面有一条路径通过，OR 节点就会被通过。
其它路径上的工作会被忽略。</p>
<p>这一点与“衔接”节点不同，“衔接”节点的作用只是用于衔接线路，对运行逻辑不作控制</p>
<h2 id="_46">接地节点 <img src="../../img/svg/GROUND.svg" width="24px" height="24px"/></h2>
<p>接地节点后续没有节点，即便有节点，也不会继续运行其运行路径。
接地节点的意思是流程运行到该节点时，该条路径即不会继续</p>
<h2 id="_47">连接线 <img src="../../img/svg/CONNECT.svg" width="24px" height="24px"/></h2>
<p>把两个节点连接起来，即建立了从前一个节点到后一个节点的运行路径。
点击一个节点 A 后，再点击另一个节点 B，将在 A 到 B 之间建立一个连接线。</p>
<p>Shift-点击一个连接线，将显示这个连接线的属性窗
在属性窗口中，给这个连接定义一个路径值，这个路径值将显示给用户，供用户选择，用户做出选择后，流程将根据其选择决定后续运行到哪里。</p>
<p>如果 A 节点是一个脚本节点，则根据脚本的返回值来决定走哪条路径。</p>
<h3 id="_48">改变连接的起止节点</h3>
<ul>
<li>按下 Alt（Windows） (MAC: Opt), 点连接的前半段，然后点一个节点，即可改换连接的起始节点。</li>
<li>按下 Alt（Windows） (MAC: Opt), 点连接的后半段，然后点一个节点，即可改换连接的终止节点。</li>
</ul>
<p>或者:</p>
<ul>
<li>鼠标指在一个连接，按"cb",然后选择新的起始节点</li>
<li>鼠标指在一个连接，按"ce",然后选择新的终止节点</li>
</ul>
<h3 id="_49">取消连接选择</h3>
<p>在选择起始或终止节点的过程中，随时按下 ESC 键盘或者双击空白区域，即可终止连接建立</p>
<h3 id="_50">删除一个连接</h3>
<ul>
<li>Mouse over a connection, then press Backspace or Delete</li>
<li>鼠标指在一个连接，按下 Backspace/Delete 键或 d 键</li>
</ul>
<h3 id="_51">给连接一个路径值</h3>
<ul>
<li>按住 Shift 的同时点连接，在弹出的属性窗口中输入</li>
<li>鼠标指向一个连接，按下'ct'删除其连接路径值</li>
<li>鼠标指向一个连接，安详 Ctrl-C/Cmd-C 拷贝其路径值，然后指向另一个连接，按下 Ctrl-V/Cmd-V 粘贴其路径值</li>
</ul>
<h2 id="_52">编辑操作</h2>
<p>流程设计器支持拷贝、粘贴、剪切等操作，也支持多个键盘快捷键，以便方便你的操作
Ctrl 为 Windows 上的 Control 按键
Cmd 为 Mac 电脑上的 Command 按键，后续不再重复说明</p>
<h3 id="_53">拷贝、粘贴节点</h3>
<p>当鼠标滑过一个节点时，Windows 上按 Ctrl-C， Mac 上按 Cmd-C 即可拷贝这个节点，然后，移动鼠标到另一个空白位置，按下 Ctrl-V 或 Cmd-V， 即可在空白位置粘贴出前述节点的一个拷贝。如在另一个节点上按下 Ctrl-V 或 Cmd-V，
这个节点将被替换为第一个节点的副本。</p>
<p>鼠标滑过一个节点时，按下 Ctrl-X/Cmd-X 将剪切掉该节点，然后在另一个位置按下 Ctrl-V/Cmd-V 将粘贴出该节点</p>
<h3 id="_54">连接线文本</h3>
<p>鼠标滑过一个连接线时，按下 Ctrl-C/CMD-C 将拷贝该连接线上的路由文本，然后移动鼠标到另一个连接线，按下 Ctrl-V/Cmd-V 将把文本粘贴给这个新的连接线。如第二个连接线已有文本，其文本将被覆盖。</p>
<h3 id="_55">键盘快捷键</h3>
<p>鼠标滑过一个节点时：</p>
<ul>
<li>d: 删除这个节点</li>
<li>gt: 连接到另一个节点</li>
</ul>
<p>鼠标滑过一个连接线时：</p>
<ul>
<li>cb: 改变其起始节点</li>
<li>ce: 改变其结束节点</li>
<li>ct：改变其文本</li>
</ul>
<h3 id="-">单选-多选</h3>
<p>单选： 单点节点
多选： 保持 Win/Mac 键按下，连续点击节点
框选： 保持 Shift 按下，滑动鼠标框出区域
全选： Ctrl-A / Cmd-A</p>
<h3 id="_56">移动节点</h3>
<p>点击并拖动，可移动单个节点
多选/框选/全选节点后， 移动其中一个，即可移动全部</p>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../explorer.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: 流程浏览" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              流程浏览
            </div>
          </div>
        </a>
      
      
        
        <a href="pds.html" class="md-footer__link md-footer__link--next" aria-label="Next: 角色定义" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              角色定义
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright Lucas-Kehong-Liu, 2003-2022
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["toc.integrate", "navigation.top", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.sections"], "search": "../../../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>